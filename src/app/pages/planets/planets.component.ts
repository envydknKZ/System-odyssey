import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common'; // <--- Обязательно!
import { PlanetDataService } from '../../services/planet-data.service';

@Component({
  selector: 'app-planets',
  standalone: true,
  imports: [CommonModule], // <--- Обязательно для *ngIf, *ngFor и т.д.
  templateUrl: './planets.component.html',
  styleUrls: ['./planets.component.css']
})
export class PlanetsComponent implements OnInit {
  planets: any[] = [];

  planetImages: { [key: string]: string } = {
    Mercury: 'assets/planets/mercury.png',
    Venus: 'assets/planets/venus.png',
    Earth: 'assets/planets/earth.png',
    Mars: 'assets/planets/mars.png',
    Jupiter: 'assets/planets/jupiter.png',
    Saturn: 'assets/planets/saturn.png',
    Uranus: 'assets/planets/uranus.png',
    Neptune: 'assets/planets/neptune.png'
  };

  planetComposition: { [key: string]: string } = {
    Mercury: `Железо (около 70%) — составляет огромное твёрдое ядро, 
      кремний и кислород (около 30%) — основа скалистой мантии и тонкой коры. 
      Из-за слабой атмосферы и близости к Солнцу, на поверхности практически нет воды, 
      но в некоторых кратерах могут быть залежи водяного льда.`,
  
    Venus: `Каменные породы (примерно 90%) — мантия богата базальтами, ядро металлическое (10%). 
      Атмосфера содержит углекислый газ и следы серной кислоты. 
      Следов воды в жидком виде не обнаружено, но в далёком прошлом, возможно, на Венере существовали океаны.`,
  
    Earth: `Железо (32%) — в ядре, кислород (30%) и кремний (15%) — в составе коры и мантии. 
      Около 71% поверхности покрыто водой: океаны, моря, реки и озёра. 
      Атмосфера содержит азот (78%), кислород (21%), водяной пар и углекислый газ. 
      Земля — единственная известная планета с устойчивым гидросферным циклом и биосферой.`,
  
    Mars: `Кремний, кислород, железо и магний составляют основную часть поверхности. 
      Характерный красный цвет обусловлен оксидами железа. 
      На полюсах имеются ледяные шапки из водяного льда и сухого льда (CO₂). 
      В подповерхностных слоях обнаружены следы воды и льда, что повышает интерес к потенциальной жизни.`,
  
    Jupiter: `Водород (около 90%) и гелий (10%) — основные компоненты атмосферы. 
      Также имеются следы метана, аммиака, водяного пара и других веществ. 
      Глубоко внутри — возможно наличие металлического водорода. 
      Вода существует в виде пара и в составе облачных слоёв, но на поверхности её нет.`,
  
    Saturn: `Водород (96%) и гелий (3%) — атмосфера планеты. 
      Присутствуют следы метана, аммиака и водяного пара. 
      В кольцах планеты содержится огромное количество водяного льда. 
      Внутри может существовать водяной слой между металлическим и каменным ядром.`,
  
    Uranus: `Водород (82%), гелий (15%) и метан (2%) в атмосфере. 
      Внутренности состоят из воды, аммиака и метана в виде "льда", образуя так называемый "океан мантии". 
      Несмотря на холод, планета содержит больше воды, чем Земля, но в связанном состоянии.`,
  
    Neptune: `Водород (80%) и гелий (19%), метан (1%) в верхних слоях атмосферы. 
      Под плотной атмосферой располагается водяной и аммиачный океан. 
      Планета содержит огромные запасы воды в замороженном и жидком виде, но доступ к ней невозможен из-за экстремальных условий.`
  };

  planetFeatures: { [key: string]: string } = {
    Mercury: 'Очень тонкая атмосфера, огромные перепады температур',
    Venus: 'Парниковый эффект, кислотные облака, вулканическая активность',
    Earth: 'Единственная обитаемая планета, наличие воды в трёх агрегатных состояниях',
    Mars: 'Возможность жизни в прошлом, пыльные бури, ледяные полярные шапки',
    Jupiter: 'Большое красное пятно — гигантский шторм, самая большая планета',
    Saturn: 'Кольца из льда и камней, может плавать в воде',
    Uranus: 'Ось вращения почти лежит в плоскости орбиты, возможны дожди из алмазов',
    Neptune: 'Сильнейшие ветры в Солнечной системе, вероятны дожди из алмазов'
  };

  constructor(private planetService: PlanetDataService) {}

  ngOnInit(): void {
    this.planetService.getPlanets().subscribe((data: any) => {
      this.planets = data.bodies.map((el: any) => {
        return {
          mass: el.mass,
          gravity: el.gravity,
          planetFeatures: this.planetFeatures[el.englishName],
          planetComposition: this.planetComposition[el.englishName]
        };
      });
    });
  }
}
